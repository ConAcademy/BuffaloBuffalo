# AGENTS.md - Agent Documentation

## Project Overview

**BuffaloBuffalo** is a TypeScript web application for constructing, visualizing, and interpreting Buffalo sentences—demonstrating how a single word can serve multiple grammatical functions.

## Documentation Map

| File | Purpose | Editable |
|------|---------|----------|
| README.md | Human-readable project overview | Yes |
| AGENTS.md | Agent instructions (this file) | Yes |
| MEMORY.md | Long-term concepts and decisions | Yes |
| PLAN.md | Implementation planning | Yes |
| PROMPTS.md | Auto-generated by hook | **READ ONLY** |

## Core Components

### 1. Parse Tree Generator (Complete)
- Earley parser for ambiguous CFG grammars
- Dictionary-driven (Lexicon + Grammar classes)
- Handles multiple valid parses (capped at 100)
- Deduplicates identical parse trees
- Unit tests use non-Buffalo words to verify parser correctness
- Buffalo-specific lexicon with three valid parts of speech

### 2. Visualization Engine (Complete)
- SVG-based parse tree rendering
- Two layout styles: Tree view and Reed-Kellogg
- Color-coded nodes by part of speech
- Position badges showing word order (1-indexed)
- Golden Buffalo wildcard indicator (star badge)
- Curved connector lines between nodes

### 3. Web Application (Complete)
- **Two modes**: Grammar Mode (constrained) and Wild Mode (explore all)
- Grammar Mode: POS buttons (Adjective, Noun, Verb), defaults to A-N-V pattern
- Wild Mode: Brown buffalo buttons, all wildcards, warns at 5+ words
- Golden Buffalo wildcard in Grammar Mode (limited to one per sentence)
- Auto-parsing on any change (no parse button needed)
- Loading spinner for complex parses
- Drag-and-drop word reordering
- Drag buttons directly into sentence bar
- Drag words off to remove (with poof animation)
- Hover X button to remove words
- Preset buttons for common sentence lengths (Grammar Mode only)
- Previous/Next navigation for multiple parses
- Mobile responsive design

### 4. Interpretation Engine (Complete)
- Rule-based interpreter converts parse trees to plain English
- Color-coded output matches visualization colors
- Superscript position numbers link words to tree nodes
- Handles relative clauses, compound sentences, etc.

### 5. LLM Integration (Not Implemented)
- Future feature: enhanced interpretation via LLM
- API choice TBD

## Technical Constraints

- **Language**: TypeScript (strict mode)
- **Framework**: Vanilla TypeScript + HTML (zero runtime dependencies)
- **Build**: Vite for development and bundling
- **Testing**: Vitest (58 tests passing)
- **Style**: Minimal, focused codebase

## Agent Guidelines

1. **Read MEMORY.md** before making architectural decisions
2. **Update MEMORY.md** when making significant decisions
3. **Follow PLAN.md** for implementation order
4. **Never write to PROMPTS.md** (hook-generated)
5. Prefer editing existing files over creating new ones
6. Keep the codebase minimal and focused

## Key Linguistic Rules

Buffalo has exactly three valid forms:
- `Buffalo` (proper noun/PN) → the city in New York (acts as adjective modifier)
- `buffalo` (noun/N) → the animal (bison)
- `buffalo` (verb/V) → to intimidate, bully, or bewilder

**Invalid forms removed:**
- Adverb - "buffalo" has no standard adverbial usage
- Conjunction - "buffalo" is never a conjunction

Valid sentence patterns follow standard English CFG rules with support for:
- Basic sentences (S → NP VP)
- Imperative sentences (S → VP)
- Exclamatory sentences (S → NP)
- Reduced relative clauses (critical for Buffalo sentences)
- Compound sentences (S → S CONJ S) - requires actual conjunction words
